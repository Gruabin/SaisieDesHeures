{% trans_default_domain 'temps' %}
{% extends 'base.html.twig' %}
{% block title %}
    {{'Saisie des heures'|trans}}
{% endblock %}
{% block body %}
    <section class="mx-24 my-16 max-2xl:mx-8 max-lg:mx-4 max-sm:mx-1 rounded-md bg-neutral-100 border-b-[5px] border-gruau-red py-6 text-lg max-sm:text-base shadow-md" id="temps">
        <h2 class="text-center text-4xl text-gruau-dark-blue font-bold">{{'Synthèse employé'|trans}}</h2>
        <hr class="w-14 mx-auto h-[3px] bg-gruau-red my-6 text-gruau-red">
        <div class="flex flex-col lg:flex-row lg:items-center p-2">
            <div class="m-2 flex-1">
                <div class="m-2">
                    <b>{{'Employé'|trans}}</b>
                </div>
                <div id="codeEmploye" class="m-2">{{ user.id }}
                    {{ user.nomEmploye }}</div>
            </div>
            <div class="m-2 flex-1">
                <div class="m-2">
                    <b>{{'Centre de charge'|trans}}</b>
                </div>
                <div class="m-2" id="CDGUser">
                    {{ user.centreDeCharge.id }}
                </div>
            </div>
            <div class="m-2 flex-1">
                <div class="m-2">
                    <b>{{'Date'|trans}}</b>
                </div>
                <div class="m-2">
                    {{ 'now'|date('d/m/Y', 'Europe/Paris') }}
                </div>
            </div>
            <div class="m-2 flex-1">
                <div class="m-2">
                    <b>{{'Temps journalier'|trans}}</b>
                </div>
                <div class="m-2">
                    <span>
                        {% if nbHeures > 0 %}
                            {{ nbHeures }}
                            {% if nbHeures < 2 %}
                                {{'heure'|trans}}
                            {% else %}
                                {{'heures'|trans}}
                            {% endif %}
                        {% endif %}
                    </span>
                </div>
            </div>
            <div class="m-2 flex-1">
                <div class="m-2">
                    <a target="_self" class="btn btn-primary mt-5" id="btnConsulterDetails" href="{{ path('historique') }}">
                        {{'Consulter le détail'|trans}}
                    </a>
                </div>
            </div>
        </div>
    </section>
    <section class="mx-24 my-16 max-2xl:mx-8 max-lg:mx-4 max-sm:mx-1 rounded-md bg-neutral-100 border-b-[5px] border-gruau-red py-6 text-lg max-sm:text-base shadow-md">
        <h2 class="text-center text-4xl text-gruau-dark-blue font-bold">{{'Saisie des heures'|trans}}</h2>
        <hr class="w-14 mx-auto h-[3px] bg-gruau-red my-6 text-gruau-red">
        <div class="flex flex-col flex-wrap text-center p-2">
            <div class="w-fit self-center">
                <div id="alertSuccess" role="alert" class="alert alert-success hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <span></span>
                </div>
                <div id="alertError" role="alert" class="alert alert-error hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <span>{{'erreur survenue'|trans}} <a href="https://supportinfo.gruau.com/glpi/plugins/formcreator/front/wizard.php" class="underline noLoading" target="_blank"> {{'Support informatique'|trans}}</a>.</span>
                </div>
            </div>
            <div class="my-3 flex md:flex-row flex-col" id="divType">
                <div class="flex-1 text-left md:text-right md:self-center m-3">
                    <label for="type">
                        <b>{{"Type d'heures"|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:flex md:self-center items-center">
                    <div class="md:self-center">
                        <select class="select focus:ring-primary mx-3" {% if nbHeures >= 12 %}disabled{% endif %} name="type" id="type">
                            <option value="-1" {% if favoriTypeHeure is null %}selected{% endif %}>{{"Sélectionner type heure"|trans}}</option>
                            {% for type in types %}
                                {% if favoriTypeHeure is not null and favoriTypeHeure.typeHeure is not null %}
                                    <option {% if favoriTypeHeure.typeHeure.id == type.id %}selected{% endif %} value="{{ type.id }}">{{ type.nomType }}</option>
                                {% else %}
                                    <option value="{{ type.id }}">{{ type.nomType }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    <div class="tooltip" data-tip="{{'Enregistrer par défaut'|trans}}">
                        <button class="btn btn-sm btn-success" id="btnEnregistrerParDefaut">
                            <span id="iconTransparent" class="w-4 hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M48 96V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V170.5c0-4.2-1.7-8.3-4.7-11.3l33.9-33.9c12 12 18.7 28.3 18.7 45.3V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H309.5c17 0 33.3 6.7 45.3 18.7l74.5 74.5-33.9 33.9L320.8 84.7c-.3-.3-.5-.5-.8-.8V184c0 13.3-10.7 24-24 24H104c-13.3 0-24-10.7-24-24V80H64c-8.8 0-16 7.2-16 16zm80-16v80H272V80H128zm32 240a64 64 0 1 1 128 0 64 64 0 1 1 -128 0z"/></svg>
                            </span>
                            <span id="iconPlein" class="w-4 hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col w-full" id="divOrdre">
                <div class="flex-1 text-left md:text-right md:self-center m-3">
                    <label for="ordre">
                        <b>{{'Ordre'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left items-center">
                    <label class="input input-bordered flex items-center gap-2 max-w-40">
                        <span id="labelOrdre">{{ site }}</span>
                        <input type="text" name="ordre" id="ordre" class="w-28" maxlength="9" pattern="^[0-9A-Za-z]{1}[0-9]{6}$"/>
                    </label>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divActivite">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label for="activite">
                        <b>{{'Activité'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:self-center items-center">
                    <input class="input focus:ring-primary mx-3" type="text" name="activite" id="activite" maxlength="4" pattern="^[0-9]{4}$">
                    <p class="mx-3" id="infoActivite"></p>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divTache">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label for="tache">
                        <b>{{'Tâche'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:flex md:self-center items-center">
                    <div class="md:self-center">
                        <select class="select focus:ring-primary mx-3" name="tache" id="tache">
                            <option value="-1">{{'Sélectionner tâche'|trans}}</option>
                            {% for tache in taches %}
                                <option data-idtype="{{ tache.typeHeures.id }}" value="{{ tache.id }}">{{ tache.id }}
                                    -
                                    {{ tache.nomTache }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divOperation">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label class="mx-3" for="operation">
                        <b>{{'Opération'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:self-center items-center">
                    <input class="input focus:ring-primary mx-3" type="number" name="operation" id="operation" max="999" min="0" step="10">
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divTacheSpe">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label class="mx-3" for="tacheSpe">
                        <b>{{'Tâche spécifique'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 flex text-left md:flex md:self-center items-center">
                    <input type="checkbox" class="checkbox checkbox-primary" id="cbTacheSpe"/>
                    <select class="select mx-3 focus:ring-primary" disabled name="tacheSpe" id="tacheSpe">
                        <option value="-1" selected>{{'Sélectionner tâche spécifique'|trans}}</option>
                        {% for tache in tachesSpe %}
                            <option value="{{ tache.id }}">{{ tache.id }}
                                -
                                {{ tache.description }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divCentreCharge">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label for="centrecharge">
                        <b>{{'Centre de charge'|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:flex md:self-center items-center">
                    <select class="select focus:ring-primary mx-3" name="centrecharge" id="centrecharge">
                        <option value="-1">{{'Sélectionner centre charge'|trans}}</option>
                        {% for centre_charge in CDG %}
                            <option value="{{ centre_charge.id }}">{{ centre_charge.id }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="my-3 hidden flex md:flex-row flex-col" id="divSaisieTemps">
                <div class="flex-1 text-left md:text-right md:self-center m-2">
                    <label for="saisieTemps">
                        <b>{{"Temps main d'oeuvre"|trans}}</b>
                    </label>
                </div>
                <div class="flex-1 text-left md:self-center items-center">
                    <input class="input focus:ring-primary mx-3" type="number" max="100" step=".25" name="saisieTemps" id="saisieTemps">
                </div>
            </div>
        </div>
        <div class="flex flex-row flex-wrap justify-center items-center space-x-2 p-2">
            <div id="informationSaisiHeures"></div>
        </div>
        <input type="hidden" name="token" id="saisieToken" value="{{ csrf_token('saisieToken') }}">
        <div class="flex md:flex-row flex-col-reverse flex-wrap justify-center items-center space-x-2 p-2">
            <a target="_self" class="btn btn-primary mt-5" id="btnReturn" href="{{ path('deconnexion') }}">
                {{'Quitter'|trans}}
            </a>
            <button class="btn btn-primary mt-5 {% if nbHeures >= 12 %}btn-disabled{% endif %}" id="btnEnregistrerQuitter">
                {{'Enregistrer et quitter'|trans}}
            </button>
            <button class="btn btn-primary mt-5 {% if nbHeures >= 12 %}btn-disabled{% endif %}" id="btnEnregistrerContinue">
                {{'Enregistrer et continuer'|trans}}
            </button>
        </div>
    </section>
{% endblock %}
