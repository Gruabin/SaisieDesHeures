{% extends 'base.html.twig' %}
{% block title %}
    Saisie des heures
{% endblock %}
{% block body %}
    <section class="card mx-24 my-4 max-2xl:mx-8 max-lg:mx-4 max-sm:mx-1 bg-base-100 border-b-[5px] border-accent text-lg max-sm:text-base" id="temps">
        <div class="card-body">
            <div class="flex flex-row items-center max-sm:text-center">
                <div class="m-2 flex-1">
                    <div class="m-2">
                        <b>Employé</b>
                    </div>
                    <div id="codeEmploye" class="m-2">{{ app.user.id }}
                        {{ app.user.nomEmploye }}</div>
                </div>
                <div class="m-2 flex-1 md:block hidden">
                    <div class="m-2">
                        <b>Centre de charge</b>
                    </div>
                    <div class="m-2" id="CDGUser">
                        {{ app.user.centreDeCharge.id }}
                    </div>
                </div>
                <div class="m-2 flex-1 md:block hidden">
                    <div class="m-2">
                        <b>Date</b>
                    </div>
                    <div class="m-2">
                        {{ 'now'|date('d/m/Y', 'Europe/Paris') }}
                    </div>
                </div>
                <div class="m-2 flex-1">
                    <div class="m-2">
                        <b>Temps journalier</b>
                    </div>
                    <div class="m-2">
                        <span>
                            {% if nbHeures > 0 %}
                                {{ nbHeures }}
                                {% if nbHeures < 2 %}
                                    heure
                                {% else %}
                                    heures
                                {% endif %}
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="m-2 flex-1 md:block hidden">
                    <div class="m-2">
                        <a target="_self" class="btn btn-primary mt-5" id="btnConsulterDetails" href="{{ path('historique') }}">
                            Consulter le détail
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="card mx-24 my-4 max-2xl:mx-8 max-lg:mx-4 max-sm:mx-1 bg-base-100 border-b-[5px] border-accent text-lg max-sm:text-base">
        <div class="card-body">
            <div class="flex flex-col flex-wrap max-sm:items-center text-center">
                <div class="w-fit self-center">
                    <div id="alertSuccess" role="alert" class="alert alert-success hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <span></span>
                    </div>
                    <div id="alertError" role="alert" class="alert alert-error hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <span>Une erreur est survenue. Veuillez contacter le <a href="https://supportinfo.gruau.com/glpi/plugins/formcreator/front/wizard.php" class="underline noLoading" target="_blank">Support informatique</a>.</span>
                    </div>
                </div>
                <div class=" flex md:flex-row flex-col" id="divType">
                    <div class="flex-1 text-center md:text-right md:self-center m-3">
                        <label for="type">
                            <b>Type d'heures</b>
                        </label>
                    </div>
                    <div class="flex-1 text-center flex items-center">
                        <div class="self-center">
                            <form method="GET" action="{{ path('type_select') }}" data-turbo-frame="formulaire_saisie" class="noLoading">
                                <select class="select mx-3 w-auto dark:border-primary" {% if nbHeures >= 12 %}disabled{% endif %} name="type" id="type" onchange="this.form.requestSubmit()">
                                    <option value="-1" {% if favoriTypeHeure is null %}selected{% endif %}>-- Sélectionner un type d'heure --</option>
                                    {% for type in types %}
                                        {% if favoriTypeHeure is not null and favoriTypeHeure.typeHeure is not null %}
                                            <option {% if favoriTypeHeure.typeHeure.id == type.id %}selected{% endif %}
                                                    value="{{ type.id }}">
                                                {{ type.nomType }}
                                            </option>
                                        {% else %}
                                            <option value="{{ type.id }}">{{ type.nomType }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </form>
                            <div class="tooltip" data-tip="Enregistrer par défaut">
                                <button class="btn btn-sm btn-success" id="btnEnregistrerParDefaut">
                                    <span id="iconTransparent" class="w-4 hidden">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M48 96V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V170.5c0-4.2-1.7-8.3-4.7-11.3l33.9-33.9c12 12 18.7 28.3 18.7 45.3V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H309.5c17 0 33.3 6.7 45.3 18.7l74.5 74.5-33.9 33.9L320.8 84.7c-.3-.3-.5-.5-.8-.8V184c0 13.3-10.7 24-24 24H104c-13.3 0-24-10.7-24-24V80H64c-8.8 0-16 7.2-16 16zm80-16v80H272V80H128zm32 240a64 64 0 1 1 128 0 64 64 0 1 1 -128 0z"/></svg>
                                    </span>
                                    <span id="iconPlein" class="w-4 hidden">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <turbo-frame id="formulaire_saisie" src="{{ path('chargement_formulaire', {'typeId': favoriTypeHeure.typeHeure.id }) }}">
                    Chargement...
                </turbo-frame>

                <div class="flex flex-row flex-wrap justify-center items-center p-2">
                    <div id="informationSaisiHeures"></div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
